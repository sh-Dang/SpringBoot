<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

</head>
<body>
    <div>
        <h3>단일 파일 업로드</h3>
        <form id="form1">
            <input type="file" name="file">
            <input type="button" value="사진 업로드">
        </form>
    </div>

    <div>
        <h3>다중 파일 업로드</h3>
        <form id="form2">
            <input type="file" id="fileList" name="files" multiple>
            <input type="button" value="사진 업로드">
        </form>
    </div>
<script>
    //파일을 서버에 비동기로 전송
    function registerImage(){
        //FormData 객체사용
        const formData = new FormData(document.getElementById("form1"));
        $.ajax({
            url : "/file/upload",
            method : "POST",
            data : formData,
            processData : false,
            contentType : false,
            success : data=>{
                console.log(data);
            },
            error : data=>{
                console.log(data);
            }
        });
    }

    function registerMulti(){
        const formData = new FormData(); //비어있는 폼 데이터를 선언
        console.log("유저가 선택한 파일 수는", document.getElementById("fileList").files.length);
        for(const file of document.getElementById("fileList").files){
            //ajax의 비동기 업로드를 위해 formData에 유저가 선택한 파일들을 옮겨심자
            formData.append("files", file); //files라는 파라미터명을 이용하여 배열 생성
        }

        $.ajax({
            url : "/files/upload",
            method : "POST",
            data : formData,
            processData : false, //ajax 전송 시 필수
            contentType : false, //ajax 전송 시 필수
            success : data=>{
                console.log(data);
            },
            error : data=>{
                console.log(data);
            }
        });
    }

    $("input[type='button']").click(()=>{
        registerImage();
    });

    $("#form2 input[type='button']").click(()=>{
        registerMulti();
    });

</script>
</body>
</html>